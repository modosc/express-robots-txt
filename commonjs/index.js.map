{"version":3,"file":"index.js","names":["_fs","_interopRequireDefault","require","_express","_os","obj","__esModule","default","asArray","value","undefined","Array","isArray","render","config","SitemapArray","HostArray","output","map","robot","userAgentArray","UserAgent","userAgent","push","CrawlDelay","Sitemap","concat","Host","Disallow","disallow","line","join","EOL","length","sitemap","host","buildRobots","fs","readFileSync","robots","router","Router","get","req","res","header","send","_default","exports","module"],"sources":["../esm/index.mjs"],"sourcesContent":["import fs from 'fs'\nimport { Router } from 'express'\nimport { EOL } from 'os'\n\nconst asArray = function asArray(value) {\n  if (value === undefined) return []\n  if (Array.isArray(value)) return value\n  return [value]\n}\n\nfunction render(config) {\n  let SitemapArray = []\n  let HostArray = []\n  let output = asArray(config).map((robot) => {\n    let userAgentArray = []\n    if (Array.isArray(robot.UserAgent)) {\n      userAgentArray = robot.UserAgent.map((userAgent) => `User-agent: ${userAgent}`)\n    } else {\n      userAgentArray.push(`User-agent: ${robot.UserAgent}`)\n    }\n    if (robot.CrawlDelay) {\n      userAgentArray.push(`Crawl-delay: ${robot.CrawlDelay}`)\n    }\n\n    if (robot.Sitemap) {\n      SitemapArray = SitemapArray.concat(robot.Sitemap)\n    }\n    if (robot.Host) {\n      HostArray = HostArray.concat(robot.Host)\n    }\n\n    return userAgentArray.concat(asArray(robot.Disallow).map((disallow) => {\n      if (Array.isArray(disallow)) {\n        return disallow.map((line) => `Disallow: ${line}`).join(EOL)\n      }\n      return `Disallow: ${disallow}`\n    })).join(EOL)\n  }).join(EOL)\n\n  if (SitemapArray.length > 0) {\n    output += `${EOL}${SitemapArray.map((sitemap) => `Sitemap: ${sitemap}`).join(EOL)}`\n  }\n  if (HostArray.length > 0) {\n    output += `${EOL}${HostArray.map((host) => `Host: ${host}`).join(EOL)}`\n  }\n\n  return output\n}\n\nfunction buildRobots(config) {\n  if (config) {\n    if (typeof config === 'string') {\n      return fs.readFileSync(config, 'utf8')\n    }\n    return render(config)\n  }\n  return ''\n}\n\nfunction robots(config) {\n  const router = Router()\n\n  router.get('/robots.txt', (req, res) => {\n    res.header('Content-Type', 'text/plain')\n    res.send(buildRobots(config))\n  })\n\n  return router\n}\n\nexport default robots\n"],"mappings":"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"}